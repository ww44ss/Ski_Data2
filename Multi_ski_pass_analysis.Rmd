---
title: "Multi Ski Pass Exploratory Analysis"
author: "Winston Saunders"
date: "June 20, 2015"
output: 
  html_document:
    toc: true
    number_sections: true
---

#Summary  
This presentation looks at skier data in the form of chairlift rides for individual skip pass holders. Skier "days" for multiple seasons (05-06 to 14-15) were downloaded from a website which publishes them as a service to passholders. From each skier day a link was composed and used to get individual lift rides for each skier day.  

In many cases over 1000 ski runs were documented for an individual skier.  

The purpose of this exercise it to understand the reliability with which skier "fraud" (that is the use of a ski pass by other than the owner) can be detected from this data. 

Key findings include:   
1. Skier behavior is remarkably reproducile on a day to day basis.  


#Data Structure  

All ski runs for seasons 05-06 through 14-15 of individual skiers, including the date and time of every chairlift ride, and the chair elevation gain, are documented. Currently data for 122 skiers have been documented.  In the analysis below, to save time, only a subset are examined in these exploratory cases.  


```{r, echo=FALSE, warning=FALSE, message=FALSE}
library(timeDate)
library(chron)
library(ggplot2)
library(xtable)
library(digest)
library(plyr)
library(dplyr)
library(reshape2)



Directory <- "/Users/winstonsaunders/Documents/Ski_data2/Pass_data/"
valid_pass<-list.files(Directory)
```
 
 
```{r "season function", echo=FALSE}

season_function <- function(date) {
        ## this recomputes the two-year representation of ski season from the date
        ## and returns the value as a character
        
        ss1 <- as.POSIXlt(date)
        
        ## compute the starting year of season
        if (as.integer(ss1$mon) > 8) {
            y1<-as.integer(ss1$year) + 1900
        } else {
            y1<-as.integer(ss1$year) + 1900 -1
            }
        
        ##get the last digits
        y1<-y1-2000
        y2<-y1+1
        
        if (y1<10) y1_char<-paste0("0", as.character(y1)) else y1_char <- as.character(y1)
        if (y2<10) y2_char<-paste0("0", as.character(y2)) else y2_char <- as.character(y2)
        
        season_character <- paste0(y1_char, "-", y2_char)
        
        return(season_character)
    
    }


```
 
```{r "ordered sample function", echo=FALSE}

ordered_sample <- function(dataframe, n=6) {
        ## this function creates an ordered sampling of n rows from a data frame
        
        ord_samp<-sample(1:nrow(dataframe), n)
        ord_samp<-sort(ord_samp, decreasing=TRUE)
        
        return(ord_samp)
    }


```


 
##Raw Data

<style>

table { 
    display: table;
    border-collapse: collapse;
    border-spacing: 10px;
    border-color: gray;
    background-color: #a1b2c3;
    text-align: center
    font: 12px arial, sans-serif;
}
th, td {
    
    padding: 5px;
}
</style>
 
Just to give a flavor for the data, here is a sample of ski runs for an individual skier. Note that the sample spans multiple years.  


```{r, echo=FALSE, results='asis', fig.align='center'}

holidays_season = holidayNYSE(2005:2015)

set.seed(8765309)

for (pass in sample(valid_pass, 1)) {
    ski_runs<-read.csv(paste0(Directory, pass))
    
    ## suppress pass_id
    ski_runs$pass_id<-NULL
    
    ski_runs$pass<-digest(ski_runs$pass, algo="crc32")
}

print(xtable(ski_runs[ordered_sample(ski_runs, 9),]), type='html', comment=FALSE, include.rownames=FALSE, 
      html.table.attributes='border="2" align="center" ' )

```

##Summarized for daily data

Each skier makes between about 50 and 200 runs per season, so we need a way to meaningfully summarize the data. First let's explore looking at daily total runs and vertical feet.



###Totals Runs Per Day

Here is a sample of the data for total runs per day per skier.

```{r, "runs_per_day",echo=FALSE, results='asis', fig.align='center'}
set.seed(8675309)
big_skier_record<-NULL

holidays_season = holidayNYSE(2005:2015)

pass_sample <- sample(valid_pass, 23)

for (pass in pass_sample ) {
    ## read in the pass data
    # pass<-valid_pass[3]  ## for debug
    
    ski_runs<-read.csv(paste0(Directory, pass))
   
    ski_runs$count <- 1
    
    ## use rowsum for calulate total vertical feet per unique day
    runs_per_day<-rowsum(ski_runs$count, ski_runs$date)
    runs_per_day<-as.data.frame(runs_per_day)
    runs_per_day$date<-rownames(runs_per_day)
    runs_per_day$pass_id<-ski_runs$pass_id[1]


    runs_per_day <- transform(runs_per_day,
                        week = as.POSIXlt(date)$yday %/% 7 + 1,
                        season_week = (as.POSIXlt(date)$yday+31)%%365 %/% 7+1,
                        wday = as.POSIXlt(date)$wday,
                        year = as.POSIXlt(date)$year+1900,
                        weekend<-isWeekend(date),
                        holiday<-isHoliday(as.timeDate(date), holidays = holidays_season),
                        bizday<-isBizday(as.timeDate(date), holidays = holidays_season)
)

    
    
    colnames(runs_per_day)<-c("runs_per_day","date", "pass","week","season_week" ,"wday", "year", "weekend", "holiday", "bizday")
    
    runs_per_day$year<-as.integer(runs_per_day$year)
    runs_per_day$week<-as.integer(runs_per_day$week)
    ## hash the pass numbers
    set.seed(911)
    runs_per_day$pass<-digest(runs_per_day$pass, algo="crc32")
    ## make seasons
    season<- sapply(runs_per_day$date, season_function)
    season<-as.data.frame(season)
    runs_per_day<-cbind(runs_per_day, season)
    runs_per_day$season<-as.factor(runs_per_day$season)

    
    ## bind into big data frame
    big_skier_record<-rbind(big_skier_record, runs_per_day)

}

set.seed(314159)


print(xtable(big_skier_record[ordered_sample(big_skier_record, 9),]), type='html', comment=FALSE, include.rownames=FALSE, 
      html.table.attributes='border="2" align="center" ' )

```
  
  
From random sample of data from `r length(pass_sample)` out of the `r length(valid_pass)` skiers a graph below show that runs per skier are fairly consistent from season to season.  

```{r, echo=FALSE, fig.align="center", fig.height=5, fig.width=10}

 
p<-ggplot(big_skier_record, aes(x = pass, y= runs_per_day, colour=factor(season))) 
p<-p+geom_boxplot(outlier.colour = NULL)
p<-p+theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
p<-p+ggtitle("pattern of daily runs by skier")
p <- p + guides(color=guide_legend(nrow=5))
p <- p+ labs(x="skier (hashed)", y = "daily vertical (feet)")
print(p)
 
```

###Total Vertical Feet Per Day

We can also look at the number of vertical feet skied per day per skier. Again, most skiers seem to demonstrate fairly consistent behavior. 

```{r, "daily_vert",echo=FALSE, results='asis', fig.align='center'}
set.seed(8675309)
big_skier_record<-NULL

holidays_season = holidayNYSE(2005:2015)

pass_sample<-sample(valid_pass, 8)

for (pass in pass_sample) {
    ## read in the pass data
    # pass<-valid_pass[3]  ## for debug
    
    ski_runs<-read.csv(paste0(Directory, pass))
   
    
    ski_runs$weekend<-isWeekend(ski_runs$date)
    ski_runs$holiday<-isHoliday(as.timeDate(ski_runs$date), holidays = holidays_season, wday = 1:5)
    ski_runs$bizday<-isBizday(as.timeDate(ski_runs$date))

    ## use rowsum for calulate total vertical feet per unique day
    daily_vert<-rowsum(ski_runs$vertical_feet, ski_runs$date)
    daily_vert<-as.data.frame(daily_vert)
    daily_vert$date<-rownames(daily_vert)
    daily_vert$pass_id<-ski_runs$pass_id[1]


    daily_vert <- transform(daily_vert,
                        week = as.POSIXlt(date)$yday %/% 7 + 1,
                        season_week = (as.POSIXlt(date)$yday+31)%%365 %/% 7+1,
                        wday = as.POSIXlt(date)$wday,
                        year = as.POSIXlt(date)$year+1900,
                        weekend<-isWeekend(date),
                        holiday<-isHoliday(as.timeDate(date), holidays = holidays_season),
                        bizday<-isBizday(as.timeDate(date), holidays = holidays_season)
)

    
    
    colnames(daily_vert)<-c("total_vertical","date", "pass","week","season_week" ,"wday", "year", "weekend", "holiday", "bizday")
    
    daily_vert$year<-as.factor(as.integer(daily_vert$year))
    ## hash the pass numbers
    daily_vert$pass<-digest(daily_vert$pass, algo="crc32")
    ## make seasons
    season<- sapply(daily_vert$date, season_function)
    season<-as.data.frame(season)
    daily_vert<-cbind(daily_vert, season)
    daily_vert$season<-as.factor(daily_vert$season)

    
    ## bind into big data frame
    big_skier_record<-rbind(big_skier_record, daily_vert)

}

set.seed(314159)


print(xtable(big_skier_record[ordered_sample(big_skier_record, 9),]), type='html', comment=FALSE, include.rownames=FALSE, 
      html.table.attributes='border="2" align="center" ' )

```


 

A random sample of `r length(pass_sample)` of the current `r length(valid_pass)` skiers is used. Below are the first few rows of the data. (NOTE - PASS NUMBERS HAVE BEEN HASHED TO PRESERVE ANONYMITY)

There appears to be pretty good distinction between individual skiers. We can also check the data from season to season as below. Again, it appears to provide a reasonably consistent picture. 


```{r, echo=FALSE, fig.align="center", fig.height=5, fig.width=10}

 
p<-ggplot(big_skier_record, aes(x = pass, y= total_vertical, colour=factor(season))) 
p<-p+geom_boxplot(outlier.colour = NULL)
p<-p+theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
p<-p+ggtitle("pattern of daily vertical feet by skier")
p <- p + guides(color=guide_legend(nrow=5))
p <- p+ labs(x="skier (hashed)", y = "daily vertical (feet)")
print(p)
 
```



```{r, echo=FALSE, fig.align="center", fig.height=5, fig.width=10}

q<-ggplot(big_skier_record, aes(total_vertical, ..density.., color=factor(pass)))
q<-q+geom_histogram(binwidth=2000, fill='grey51', position="dodge", alpha=0.08)
q<-q+geom_density()
q <- q + guides(color=guide_legend(nrow=10))
q<-q+ggtitle("Daily Vert Shows Strong Skier Dependence")
q<-q+scale_x_continuous(limits=c(0, 30000))
print(q)



```


#Skier Speed Analytics

To analyze skier speed we need to add some more data. While the pass data tracks the vertical rise of the chairlift ride, the descent, which is the actual skiing part, is to the base of the next chairlift. Base elevations are not supplied with the downloaded data so need to be added. We can get some more data from the [Master Development Plan](http://www.mtbachelor.com/site/about_us/company_info/forest_service/MDP_Text.pdf)

```{r "base elevations", echo=FALSE}

    ## Add base elevation and nominal chairlift ride time to the data

    ## Data input
    ## base elev is in feet
    base_elev <- as.integer(c(6477,  6405,  6335, 7248, 6389, 6379, 6344, 5983,  5709))
    
    chair_names<-c("Sunrise","Rainbow","Skyliner","Summit","Sunshine", "Pine Marten","Red" , "Outback" , "Northwest" )
    
    ## ride time is in minutes
    ride_time <- c(4.2, 11.03,  5.97, 4.67, 2.13, 4.85, 8.46, 7.01,  8.38)
    
    ## create look_up table for base and ride time data by chairlift
    look_up <- matrix(c(ride_time, base_elev), 9,2, dimnames=list(chair_names, c("ride_time", "base_elev")))
    
    ## index it to the ski_runs
   

```

```{r, "ski descent time", echo=FALSE}
    
    ## Calculate ski descent time and vertical / time
    ## the general approach will be to calculate first for each run (chair ride),
    ##      a start time, 
    ##      a start elevation, an end time, and an end elevation. 
    ##
    ## from there can calculate for each run the vertical / time of the skier.
    
    ## to start we need to break down the data into individual ski days
    
    ## create data frame columns
    ## since the end time of a run is the start time of the next run, we'll move 
    ## the data over. We'll also need to duplicate the data from teh first run of the day 
    ## assuming the day ends where it started. 

set.seed(8675309)
holidays_season = holidayNYSE(2005:2015)

big_skier_record<-NULL

pass_sample<-sample(valid_pass, 12)

for (pass in pass_sample) {
    ## read in the pass data
    
        ## pass<-pass_sample[1]   ## for debug
    ski_runs<-NULL
    
    ski_runs<-read.csv(paste0(Directory, pass))
    
    pass_s<-ski_runs$pass_id[1]
    ## suppress pass_id
    ski_runs$pass_id<-NULL
    ## hash the pass identity
    ski_runs$pass<-digest(pass_s, algo="crc32")
    
    ski_runs$holiday<-isHoliday(as.timeDate(ski_runs$date), holidays = holidays_season, wday = 1:5)
        ## change to factor
        ski_runs$holiday<-as.factor(ski_runs$holiday)
    
        ## rename to something in English
        levels(ski_runs$holiday) <- c("weekday", "holiday or weekend")
   
    ## add lookup data
    i<-cbind(match(ski_runs$chair, rownames(look_up)))
    
    ## add columns to the data frame
    ski_runs<- cbind(ride_time=look_up[i,1], base_elev=look_up[i,2], ski_runs)

    ##get rid of junk columns
    ski_runs$vertical_meters<-NULL
    ##ski_runs$date<-NULL
    ski_runs$year<-NULL
    ski_runs$month<-NULL
    ski_runs$day<-NULL
    ski_runs$time_of_day<-NULL
    
    ##print(head(ski_runs))
       
    ski_runs$elev_end<-ski_runs$base_elev
    ski_runs$chair_combo<-as.character(ski_runs$chair)
    ski_runs$time_end<-as.character(ski_runs$time)
    
    
    
    ## this need to be done on a day by day basis so we'll need to pull the data apart
    ## and reassemble after manip
    ## first step is grab unique days
    ski_days<-unique(ski_runs$date)
    
    ## define accumulator data frame
    ski_start_stop<-NULL
    
    for (days in ski_days) {
        
        ## get runs for specific day
        ss<-ski_runs[ski_runs$date==days,]
        
        
        
        shift2 <- function(x, n) c(tail(x, -n), rep(NA, n))
        
        end_elev<-ss$elev_end[1]
        ss<-transform(ss, elev_end = shift2(elev_end, 1))
        ss$elev_end[nrow(ss)]<-end_elev
        ss<-transform(ss, time_end = shift2(time_end, 1))
        ss<-transform(ss, chair_combo = shift2(chair_combo, 1))
        
        ## fix chair combo
        ss$chair_combo[nrow(ss)]<-as.character(ss$chair[1])
        
        ss$ski_time<-difftime(strptime(ss$time_end, "%Y-%m-%d %H:%M:%S"),strptime(ss$time, "%Y-%m-%d %H:%M:%S"), units = "mins" )
        
        ## calulate vertical feet/minute correcting for chairlift time
        ss$delta_vert<-ss$base_elev+ss$vertical_feet-ss$elev_end
        
        ss$ski_speed<-(ss$base_elev+ss$vertical_feet-ss$elev_end)/(as.numeric(ss$ski_time)-ss$ride_time)
        ss$chair_combo <- paste(ss$chair, as.character(ss$chair_combo))
        
        ski_start_stop<-rbind(ski_start_stop, ss)
        
    }
    
    
    
    big_skier_record<-rbind(big_skier_record, ski_start_stop)
}    

 

```

So let's look at ski speed to see if more related to a skier or to a ski run.  
Calculated ski times that are below the chairlift ride time result in "negative" speeds and are anomalous. It will be worth looking at these in more detail, because they appear to occur for some users and not others. In some cases it appears that riders may have checked in to, say Summit, but then decided to ski a different lift.
In the graph below ski speeds are shown as distributions for weekends/holidays and weekdays. 



```{r, echo=FALSE}

    ## get rid of NA values
    big_skier_record<-big_skier_record[!is.na(big_skier_record$ski_speed),]
    ## get rid of negative ski_speeds
    big_skier_record<-big_skier_record[big_skier_record$ski_speed>0,]
    big_skier_record<-big_skier_record[big_skier_record$ski_speed<600,]

```

```{r, echo=FALSE, fig.align="center", fig.height=7, fig.width=10}

 ## filter negative values out
 
 
 
p<-ggplot(big_skier_record, aes(x = pass, y= ski_speed)) 
p<-p+geom_boxplot(outlier.colour = "red")
p<-p+theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
p<-p+ggtitle("pattern of skier speed")
p <- p + guides(color=guide_legend(nrow=15))
p <- p+ labs(x="skier (hashed)", y = "ski speed (vertical feet/minute)")
#print(p)
 
```

```{r, echo=FALSE, fig.align="center", fig.height=10, fig.width=10}

q<-ggplot(big_skier_record, aes(ski_speed, fill=factor(chair), y=..density..))
q<-q+geom_histogram(binwidth=20,color="red")
#q<- q + geom_density()
q<-q+facet_grid(pass~holiday)
q <- q + guides(color=guide_legend(nrow=10))

print(q)



```

With this insight we can look at the velocity statistics of individual skiers on specific chair lifts.




#Chairlift Choice

Another preference individual skiers have is for specific chairlifts. Let's see if this can contribute to behavioral classification. To do this we'll adopt a simple model of unigram maximum likelhood estimators.
Here are the frequencies of charlift rides for a sample of skiers.  

```{r, "chairlift unigram", echo=FALSE}

set.seed(8675309)
holidays_season = holidayNYSE(2005:2015)
chair_probs<-NULL

    

    ## Function Chair Probs
    ## Passes a chair list and a ride list. 
    ## Counts the number of elements in the ride list corresponding to the chair list. 
    chair_probs <- function(ride_list, chair_list){
        rides <- factor(ride_list, levels= chair_list)
        rides<-as.data.frame.table(table(rides))
        total_rides<-sum(rides$Freq)
        z<-as.data.frame(log10((rides$Freq+0.5)/(total_rides+0.5*length(chair_list))))
        
        rownames(z)<-rides$rides
        
        return(z)
    }

    big_skier_record<-NULL

    pass_sample<-sample(valid_pass, 40)
    
    
    ## initialize some factors
    skier_probs<-NULL
    chair_list<-rownames(look_up)
    chair_list<-gsub(" ", "_", chair_list)

    skier_probs<-as.data.frame(chair_list)

    
    for (pass in pass_sample) {
    ## read in the pass data
    
    #pass<-pass_sample[2]   ## for debug
    ski_runs<-NULL
    
    ski_runs<-read.csv(paste0(Directory, pass))
    
    ##fix Pine_Marten
    ski_runs$chair<-gsub(" ", "_", ski_runs$chair)
    
    ## suppress pass_id column
    ski_runs$pass_id<-NULL
    ## hash the pass identity
    pass_s<-digest(pass, algo="xxhash32")
    ski_runs$pass<-pass_s
    
    prob<-chair_probs(ski_runs$chair, chair_list)
    
    colnames(prob)<-pass_s
    
    if (!is.null(skier_probs)) {skier_probs <- cbind(skier_probs, prob)} else {skier_probs<-prob}
    
}

## finally melt the 
skier_probs_melted<-melt(skier_probs, variable.name="pass")

```

```{r, "plot probs", echo=FALSE, fig.align="center", fig.height=4, fig.width=9}

p <- ggplot(skier_probs_melted, aes(x=pass, y=10^(value), fill=chair_list))
p <- p + geom_bar(stat="identity")
p <- p + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
p <- p + ggtitle("skier average chairlift frequency")
p <- p + guides(color=guide_legend(nrow=5))
p <- p + scale_fill_brewer(palette="Spectral")
p <- p+ labs(x="skier (hashed)", y = "chair prob")
print(p)



```

As can be seen there are strong variations in the choice of chairlifts between skiers. 

## MLE for Ski days

The approach will be to take the averaged probabilities and use the MLE's for a single skier to calculate the expected probability for each ski day for a large sample of skiers.  
Here is a sample of skier probabilities (expressed as logarithms) for a specific passholder.    
 
```{r "skier probs", echo=FALSE, results="asis"}


    ## GET SKIER SAMPLE LIST

    ## extract list of passes
    hashed_passes<-colnames(skier_probs)[-1]
    ## get a random sample as reference
    set.seed(8675309+3)
    sampled_pass<-sample(2:ncol(skier_probs),1)

    ## reduce the list to the sampled pass
    ## note this is the list of chairs and the probabilities.
    probs<-skier_probs[, c(1,sampled_pass)]

    ## print it just so you know what it looks like
    print(xtable(probs), type='html', comment=FALSE, include.rownames=FALSE, html.table.attributes='border="3" align="center" ' )

    ## get the name of the pass
    sampled_pass_hashed<-colnames(probs)[2]


```

The table above shows the probabilities for `r sampled_pass_hashed`.
We can use the same lookup methodology.

```{r, echo=FALSE}

#set.seed(8675309)
#holidays_season = holidayNYSE(2005:2015)
chair_probs<-NULL


#pass_sample<-sample(valid_pass,60)  #uncomment to take a new sample

    ski_day_prob_accumulator<-NULL

    #set.seed(8675309)

    ## get a smaple of valid passes
    #pass_sample<-sample(valid_pass, 50)

    for (pass in pass_sample){
    
        #pass<-pass_sample[1]  ## debug
        ## read the data
        ski_runs<-read.csv(paste0(Directory, pass))
    
        ## fix Pine_Marten
        ski_runs$chair<-gsub(" ", "_", ski_runs$chair)
    
        ## get unique ski days
        dates<-unique(ski_runs$date)
    

    
            for (date in dates){
        
            #date<-dates[3]  ## debug
            ski_day<- ski_runs[ski_runs$date == date, ]
        
            ## assign column lookup
            ski_day$chair_p <- probs[match(ski_day$chair, probs$chair_list), 2]
        
            ## calculate geometric mean (arthimetic mean of log)
            day_prob <- mean(ski_day$chair_p)
        
        ## filter out chort ski days
        if (length(ski_day$chair_p) < 3 ) {day_prob <- -0.2}
        
        ## hash the pass
        pass_s<-digest(pass, algo="xxhash32")
        
        ifelse(is.null(ski_day_prob_accumulator),
                        ski_day_prob_accumulator<-data.frame("date"=as.character(date), "pass"= pass_s, "day_prob"=day_prob), ski_day_prob_accumulator<-rbind(ski_day_prob_accumulator,data.frame("date"=as.character(date), "pass"=pass_s, "day_prob"=day_prob)) 
                                         )
        
        
    }
    
}

```


```{r, ,echo=FALSE, fig.align="center", fig.width=9}

## PLOT ANALYZED PROBABILITIES

    ski_day_prob_accumulator$color_code<-ski_day_prob_accumulator$pass==sampled_pass_hashed

    p <- ggplot(ski_day_prob_accumulator, aes(x=pass, y = 10^(day_prob), color=color_code))
    p <- p + geom_point(size=4, alpha=0.3)
    p <- p + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
    p <- p + ggtitle("References Day Probability")
    #p <- p + guides(color=guide_legend(nrow=5))
    p <- p+ labs(x="skier (hashed)", y = "day prob")
    
    print(p)
    
```

Here are some sample probabilities

```{r, results='asis',echo=FALSE, fig.align="center"}

table_sample_print<-ski_day_prob_accumulator[ski_day_prob_accumulator$pass==sampled_pass_hashed,-4]

print(xtable(table_sample_print[1:10,]), type='html', comment=FALSE, include.rownames=FALSE, html.table.attributes='border="2" align="center" ' )

```

###Histogram

```{r, ,echo=FALSE, fig.align="center", fig.width=9}

## HISTOGRAM ANALYZED PROBABILITIES

## Select only a few passes to keep sane

    prob_junk<-ski_day_prob_accumulator[
        (ski_day_prob_accumulator$pass == sampled_pass_hashed |
            ski_day_prob_accumulator$pass == "71601c91" |
            ski_day_prob_accumulator$pass == "97824f8a" |
            ski_day_prob_accumulator$pass == "f3401388" |
            ski_day_prob_accumulator$pass == "8922f7a7" |
            ski_day_prob_accumulator$pass == "94078169"),
    ]

print(head(prob_junk))
    
#     q<-ggplot(prob_junk, aes(10^(day_prob), ..density.., color=factor(pass)))
#     q<-q+geom_histogram(binwidth=.1, fill='grey51', position="dodge", alpha=0.3)
#     q <-q + geom_density()
#     q <- q + guides(color=guide_legend(nrow=10))
#     q <- q + ggtitle("Probability Histograms")
#     #q<-q+scale_x_continuous(limits=c(0, 1.1))
#     print(q)

    
```

##Days of the Week
