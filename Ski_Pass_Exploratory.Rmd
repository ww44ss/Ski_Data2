---
title: "Ski Pass Exploratory"
author: "Winston Saunders"
date: "March 26, 2015"
output: html_document
---


```{r}
        ## PASS NUMBER
        Pass <- "MBA6360970"

        Directory <- "/Users/winstonsaunders/Documents/Ski_Data2/"
        
        ski_runs<-read.csv(paste0(Directory,Pass,".csv"))


```

```{r}

        head(ski_runs)


```

Let's 

```{r}
library(timeDate)
library(chron)

ski_runs$weekend<-isWeekend(ski_runs$date)
ski_runs$holiday<-isHoliday(as.timeDate(ski_runs$date), holidays = holidayNYSE(), wday = 1:5)
ski_runs$bizday<-isBizday(as.timeDate(ski_runs$date))
```

```{r}
## calculate daily vertical sums
daily_vert<-rowsum(ski_runs$vertical_feet, ski_runs$date)
daily_vert<-as.data.frame(daily_vert)
daily_vert$date<-rownames(daily_vert)


```

##Visual Summary of Ski Seasons for `r Pass`

```{r, fig.align='center', fig.height=9, fig.width=6}

daily_vert <- transform(daily_vert,
                        week = as.POSIXlt(date)$yday %/% 7 + 1,
                        wday = as.POSIXlt(date)$wday,
                        year = as.POSIXlt(date)$year+1900)

colnames(daily_vert)<-c("total_vertical","date","week","wday","year")

library(ggplot2)
p1<-ggplot(daily_vert, aes(week, wday, fill = total_vertical)) + 
  geom_tile(colour = "white") +
  scale_fill_gradientn(colours = c("lightblue", "blue", "red")) + 
  facet_wrap(~ year, ncol = 1)

print(p1)
